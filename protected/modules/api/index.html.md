---
language_tabs:
  - json
  - javascript
  - php
  - shell
  - ruby
  - python

---

# 1. Общая информация

<aside class='notice'><br />
Запрос к методам API представляет собой обращение по HTTP-протоколу к URL вида http://api.runet-id.com/<название метода>.<br />
Переменные методов передаются с помощью GET или POST параметров. В качестве результата возвращается JSON объект.<br />
Для каждого мероприятия генерируются ApiKey и Secret. Доступ к API для каждого ApiKey ограничивается списком ip-адресов.<br />
<strong>Обязательные для всех методов параметры:</strong><br />
&nbsp;&nbsp;&nbsp;&nbsp;1. ApiKey<br />
&nbsp;&nbsp;&nbsp;&nbsp;2. Hash - вычисляется по формуле md5(ApiKey+Secret)<br />
<strong>Формат возвращаемых ошибок:</strong><br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp;Error: {Code: int, Message: string}<br />
}<br />
<strong>При использовании php-API:</strong><br />
$api = new \RunetID\Api\Api(ApiKey, Secret, Cache = null);<br />
где Cache - объект класса, реализующего интерфейс \RunetID\Api\ICache
</aside>

# 2. Общие параметры

<aside class='notice'><br />
<b>Общие параметры для всех методов</b><br />
Language – переключение языка приложения и его ответов в “ru” или “en”. По-умолчанию, значение устанавливается в 'ru'.
</aside>

# 3. Авторизация

<aside class='notice'><br />
<b>Шаг 1</b><br />
Добавить следующий код на страницу с вызовом диалога авторизации<br />
window.rIDAsyncInit = function() {<br />
&nbsp;&nbsp;&nbsp;&nbsp;rID.init({<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apiKey: <key><br />
&nbsp;&nbsp;&nbsp;&nbsp;});<br />
&nbsp;&nbsp;&nbsp;&nbsp;// Additional initialization code here<br />
};<br />
<br />
// Load the SDK Asynchronously<br />
(function(d){<br />
var js, id = 'runetid-jssdk', ref = d.getElementsByTagName('script')[0];<br />
if (d.getElementById(id)) {return;}<br />
js = d.createElement('script'); js.id = id; js.async = true;<br />
js.src = '//runet-id.com/javascripts/api/runetid.js';<br />
ref.parentNode.insertBefore(js, ref);<br />
}(document));<br />
<br />
<b>Шаг 2</b><br />
Вызвать метод rID.login(); для создания окна авторизации<br />
<br />
<b>Шаг 3</b><br />
После авторизации, пользователь будет переадресован на исходную страницу с GET-параметром token (переадресация происходит в рамках окна авторизации)<br />
<br />
<b>Шаг 4</b><br />
После получения token - необходимо сделать запрос к API методу user/auth передав параметр token, полученный выше.<br />
API вернет данные авторизованного пользователя (RUNET-ID, ФИО, Место работы, Контакты).<br />
<br />
<b>При использовании php-API:</b><br />
$user = \RunetID\Api\User::model($api)->getByToken(token);<br />

</aside>



# 4. Компании

Описаие методов для работы с компаниями

## 4.1. Детальная информация о компании
Возвращает детальную информацию о компании


```javascript
alert('123');
```


```php
phpinfo();
```



## 4.2. Список
Список компаний.


```json
[
    {
        "Companies": "массив объектов User",
        "NextPageToken": "строка, если присутствует в ответе - значит доступны следующие страницы, если значение отсутствует - значит загружена последняя страница."
    }
]
```

`GET http://api.runet-id.com/company/list` 
### Parameters
Название | Тип | Описание | Значение по умолчанию
-------- | --- | -------- | ---------------------
Cluster | some variable type |  | (enum[РАЭК]) – кластер, компании которого необходимо получить. В данный момент может принимать единственное значение: РАЭК. Обязательно.
Query |  | some default value | поисковая строка.
PageToken |  |  | Указатель на следующую страницу, берется из результата последнего запроса, значения NextPageToken.
MaxResults |  |  | MaxResults (число) - максимальное количество компаний в ответе, от 0 до 200. Если нужно загрузить более 200 участников, необходимо использовать постраничную загрузку.


# 5. Мероприятия

Методы для работы с мероприятиями.

## 5.1. Залы
Список залов.


```json
[
    {
        "Id": "идентификатор",
        "Title": "название зала",
        "UpdateTime": "время последнего обновления зала (Y-m-d H:i:s)",
        "Order": "порядок вывода залов",
        "Deleted": "true - если зал удален, false - иначе."
    }
]
```

`GET http://api.runet-id.com/event/halls` 
### Parameters
Название | Описание
-------- | --------
FromUpdateTime | (Y-m-d H:i:s) - время последнего обновления залов, начиная с которого формировать список.
WithDeleted | Если параметр задан, не пустой и не приводится к false, возвращаются в том числе удаленные залы, иначе только не удаленные.


## 5.2. Изменение статуса
Изменение статуса пользователя (или добавление).


```json
{
    "Success": "true"
}
```

`GET http://api.runet-id.com/event/register` 
### Parameters
Название | Описание
-------- | --------
RunetId | Идентификатор пользователя. Обязательно.
RoleId | Идентификатор статуса, который пользователь должен получить на мероприятии. Обязательно.


## 5.3. Статусы
Список статусов.


```json
[
    {
        "RoleId": "идентификатор статуса на мероприятии",
        "RoleTitle": "название статуса",
        "UpdateTime": "время последнего обновления"
    }
]
```

`GET http://api.runet-id.com/event/roles` 


## 5.4. Участники
Список участников


```json
{
    "Users": "массив пользователей",
    "NextPageToken": "указатель на следующую страницу"
}
```

`GET http://api.runet-id.com/event/users` 
### Parameters
Название | Описание
-------- | --------
MaxResults | Максимальное количество пользователей в ответе, от 0 до 200. Если нужно загрузить более 200 участников, необходимо использовать постраничную загрузку
PageToken | Указатель на следующую страницу, берется из результата последнего запроса, значения NextPageToken
RoleId | Массив идентификаторов ролей


## 5.5. Добавление в избранное.



```json
{
    "Success": "true"
}
```

`GET http://api.runet-id.com/event/section/addFavorite` 
### Parameters
Название | Описание
-------- | --------
RunetId | Идентификатор.
SectionId | Идентификатор.


## 5.6. Удаление из избранного.



```json
{
    "Success": "true"
}
```

`GET http://api.runet-id.com/event/section/deleteFavorite` 
### Parameters
Название | Описание
-------- | --------
RunetId | Идентификатор.
SectionId | Идентификатор.


## 5.7. Список избранных
Список избранных секций.


```json
{
    "SectionId": "идентификатор секции",
    "UpdateTime": "время добавления или удаления в избранное",
    "Deleted": "true - если секция удалена из избранных секций пользователя, false - иначе."
}
```

`GET http://api.runet-id.com/event/section/favorites` 
### Parameters
Название | Описание
-------- | --------
RunetId | Идентификатор. Обязательно.
FromUpdateTime | (Y-m-d H:i:s) - время последнего обновления избранных секций пользователя, начиная с которого формировать список. Обязательно.
WithDeleted | Если параметр задан, не пустой и не приводится к false, возвращаются в том числе удаленные из избранного секции, иначе только не удаленные. Обязательно.


## 5.8. Секции
Список секций.


```json
[
    {
        "Id": "идентификатор",
        "Title": "название",
        "Info": "краткое описание",
        "Start": "время начала",
        "End": "время окончания",
        "TypeCode": "код типа секции",
        "Places": [
            "массив с названиями залов, в которых проходит секция (deprecated)"
        ],
        "Halls": [
            "массив объектов Hall"
        ],
        "Attributes": [
            "дополнительные аттрибуты (произвольный массив ключ      => значение, набор ключей и значений зависит от мероприятия)"
        ],
        "UpdateTime": "дата\/время последнего обновления",
        "Deleted": "true - если секция удалена, false - иначе"
    }
]
```

`GET http://api.runet-id.com/event/section/list` 
### Parameters
Название | Тип | Описание
-------- | --- | --------
FromUpdateTime | ssss | (Y-m-d H:i:s) - время последнего обновления секций, начиная с которого формировать список.
WithDeleted |  | Если параметр задан, не пустой и не приводится к false, возвращаются в том числе удаленные секции, иначе только не удаленные.


## 5.9. Доклады
Список докладов.<br />
&nbsp;&nbsp;&nbsp;&nbsp;User, Company, CustomText - всегда будет заполнено только одно из этих полей.<br />
&nbsp;&nbsp;&nbsp;&nbsp;Title, Thesis, FullInfo, Url - могут отсутствовать, если нет информации о докладе, либо роль не предполагает выступление с докладом (например, ведущий)


```json
[
    {
        "Id": "идентификатор",
        "User": "объект User (может быть пустым) - делающий доклад пользователь",
        "Company": "объект Company (может быть пустым) - делающая доклад компания",
        "CustomText": "произвольная строка с описанием докладчика",
        "SectionRoleId": "идентификатор роли докладчика на этой секции",
        "SectionRoleTitle": "название роли докладчика на этой секции",
        "Order": "порядок выступления докладчиков",
        "Title": "название доклада",
        "Thesis": "тезисы доклада",
        "FullInfo": "полная информация о докладе",
        "Url": "ссылка на презентацию",
        "UpdateTime": "дата\/время последнего обновления",
        "Deleted": "true - если секция удалена, false - иначе."
    }
]
```

`GET http://api.runet-id.com/event/section/reports` 
### Parameters
Название | Описание
-------- | --------
SectionId | Идентификатор секции. Обязательно
FromUpdateTime  | Время последнего обновления доклада, начиная с которого формировать список.
WithDeleted | Если параметр задан, не пустой и не приводится к false, возвращаются в том числе удаленные доклады, иначе только не удаленные.


# 6. Платежный кабинет



## 6.1. Добавление
Добавление заказа


```json
{
    "Id": "идентификатор элемента заказа",
    "Product": "объект Product",
    "Owner": "объект User (сокращенный, только основные данные пользователя)",
    "PriceDiscount": "цена с учетом скидки",
    "Paid": "статус оплаты",
    "PaidTime": "время оплаты",
    "Attributes": "массив с атрибутами (если заданы)",
    "Discount": "размер скидки от 0 до 1, где 0 - скидки нет, 1 - скидка 100%",
    "CouponCode": "код купона, по которому была получена скидка",
    "GroupDiscount": "была скидка групповая или нет"
}
```

`GET http://api.runet-id.com/pay/add` 
### Parameters
Название | Тип | Описание
-------- | --- | --------
ProductId | строка | Идентификатор товара. Обязательно.
PayerRunetId | строка | Идентификатор плательщика. Обязательно.
OwnerRunetId | строка | Идентификатор получателя товара. Обязательно.


## 6.2. Удаление
Удаление заказа


```json
{
    "Success": "true"
}
```

`GET http://api.runet-id.com/pay/delete` 
### Parameters
Название | Описание
-------- | --------
OrderItemId | Идентификатор заказа.
PayerRunetId | Идентификатор плательщика.


## 6.3. Список оплаченных заказов
Список оплаченных за пользователя заказов. Возвращает массив с купленными пользователем заказами.

`GET http://api.runet-id.com/pay/items` 
### Parameters
Название | Описание
-------- | --------
OwnerRunetId | Идентификатор.


## 6.4. Заказы
Список заказов.


```json
{
    "Items": [
        {
            "Id": "идентификатор элемента заказа",
            "Product": "объект Product",
            "Owner": "объект User (сокращенный, только основные данные пользователя)",
            "PriceDiscount": "цена с учетом скидки",
            "Paid": "статус оплаты",
            "PaidTime": "время оплаты",
            "Attributes": "массив с атрибутами (если заданы)",
            "Discount": "размер скидки от 0 до 1, где 0 - скидки нет, 1 - скидка 100%",
            "CouponCode": "код купона, по которому была получена скидка",
            "GroupDiscount": "была скидка групповая или нет"
        }
    ],
    "Orders": [
        {
            "OrderId": "идентификатор счета",
            "Number": "номер счета ()",
            "Paid": "статус оплачен\/не оплачен",
            "Url": "ссылка на счет",
            "Items": "массив объектов OrderItem",
            "CreationTime": "дата создания счета"
        }
    ]
}
```

`GET http://api.runet-id.com/pay/list` 
### Parameters
Название | Описание
-------- | --------
PayerRunetId | Идентификатор плательщика.


## 6.5. Товары
Список доступных товаров


```json
[
    {
        "Id": "идентификатор",
        "Manager": "строка, название менеджера (участие, питание и другие)",
        "Title": "название товара",
        "Price": "текущая цена",
        "Attributes": "массив ключ-значение с атрибутами товара"
    }
]
```

`GET http://api.runet-id.com/pay/products` 
### Parameters





# 7. Пользователи

Загрузка данных пользователя. Работа с пользователями.

## 7.1. Создание
Создает нового пользователя.

`POST http://api.runet-id.com/user/create` 
### Parameters
Название | Тип | Описание
-------- | --- | --------
Email | Строка | Email. Обязательно.
LastName | Строка | Фамилия. Обязательно.
FirstName | Строка | Имя. Обязательно.
FatherName | Строка | Отчество.
Phone | Строка | Телефон.
Company | Строка | Компания.
Position | Строка | Должность.


## 7.2. Детальная информация
Возвращает данные пользователя, включая информацию о статусе участия в мероприятии.


```json
{
    "RunetId": "идентификатор",
    "LastName": "фамилия",
    "FirstName": "имя",
    "FatherName": "отчество",
    "CreationTime": "дата регистрации пользователя",
    "Photo": "объект Photo({Small, Medium, Large}) - ссылки на 3 размера фотографии пользователя",
    "Email": "email пользователя",
    "Gender": "пол посетителя. Возможные значения: null, male, female",
    "Phones": "массив с телефонами пользователя, если заданы",
    "Work": "объект с данными о месте работы пользователя",
    "Status": {
        "RoleId": "идентификатор статуса на мероприятии",
        "RoleTitle": "название статуса",
        "UpdateTime": "время последнего обновления"
    }
}
```

`GET http://api.runet-id.com/user/get` 
### Parameters
Название | Описание
-------- | --------
RunetId | runetid пользователя. Обязательно.

```php
<?php $user = \RunetID\Api\User::model($api)->getByRunetId(RunetId); 
```



## 7.3. Авторизация
Авторизация, проверка связки Email и Password.


```json
{
    "RunetId": "идентификатор",
    "LastName": "фамилия",
    "FirstName": "имя",
    "FatherName": "отчество",
    "CreationTime": "дата регистрации пользователя",
    "Photo": "объект Photo({Small, Medium, Large}) - ссылки на 3 размера фотографии пользователя",
    "Email": "email пользователя",
    "Gender": "пол посетителя. Возможные значения: null, male, female",
    "Phones": "массив с телефонами пользователя, если заданы",
    "Work": "объект с данными о месте работы пользователя",
    "Status": "объект с данными о статусе пользователя на мероприятии"
}
```

`GET http://api.runet-id.com/user/login` 
### Parameters
Название | Тип | Описание
-------- | --- | --------
Email | строка | Email. Обязательно.
Password | строка | Пароль. Обязательно.
DeviceType | строка | Тип регистрируемого устройства пользователя. Обязателен, если указан параметр DeviceToken. Возможные значения: iOS, Android.
DeviceToken | строка | Уникальный идентификатор устройства для получения push-уведомлений.


## 7.4. Поиск
Поиск пользователей по базе RUNET-ID.


```json
{
    "Users": "массив пользователей",
    "NextPageToken": "указатель на следующую страницу"
}
```

`GET http://api.runet-id.com/user/search` 
### Parameters
Название | Тип | Описание
-------- | --- | --------
Query | Строка | может принимать значения Email, RunetId, список RunetId через запятую, Фамилия, Фамилия Имя, Имя Фамилия




# 8. Ошибки 

<aside class='notice'>
Описание ошибок
</aside>

Код ошибки | Описание
---------- | --------
400 | Bad Request – Your request sucks.
401 | Unauthorized – Your API key is wrong.
403 | Forbidden.
404 | Not Found.
405 | Method Not Allowed.
406 | Not Acceptable.
410 | Gone.
418 | I’m a teapot.
429 | Too Many Requests.
500 | Internal Server Error.
503 | Service Unavailable.
